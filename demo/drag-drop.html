<?php
$pageTitle = 'Drag and Drop demo';
require_once("includes/demo-header.php");
?>
<body>
<script type="text/javascript" src="../src/layout/manager.js"></script>
<script type="text/javascript" src="../src/view.js"></script>
<script type="text/javascript" src="../src/menu/button.js"></script>
<script type="text/javascript" src="../src/grid/column-manager.js"></script>
<script type="text/javascript" src="../src/framed-view.js"></script>
<script type="text/javascript" src="../src/window.js"></script>
<script type="text/javascript" src="../src/grid/grid.js"></script>
<script type="text/javascript" src="../src/grid/grid-header.js"></script>
<script type="text/javascript" src="../src/storage/storage.js"></script>
<script type="text/javascript" src="../src/view/button-bar.js"></script>
<script type="text/javascript" src="../src/effect.js"></script>
<script type="text/javascript" src="../src/effect/effect.js"></script>
<script type="text/javascript" src="../src/effect/drag.js"></script>
<script type="text/javascript" src="../src/effect/drag-drop.js"></script>
<script type="text/javascript" src="../src/effect/resize.js"></script>
<script type="text/javascript" src="../src/data-source/collection.js"></script>
<script type="text/javascript" src="../src/data-source/collection-search.js"></script>

<style type="text/css">
.ludo-shim {
    border: 15px solid #AAA;
    background-color: #DEF;
    margin: 5;
    opacity: .5;
    border-radius: 5px;
}
.box{
    position:absolute;
    border-radius:5px;
    z-index:100;
    padding:5px;
}
</style>
<div id="myDiv" style="position:absolute;z-index:5000;width:100px;height:100px;border:1px solid #000;background-color:#DEF;left:50px;top:50px"></div>
<script type="text/javascript">
new ludo.effect.Effect().fly({
	el: 'myDiv',
	duration:1,
	to:{ x:500, y: 300 },
    onComplete:function(){
        new ludo.effect.Effect().fly({
        	el: 'myDiv',
        	duration:1,
        	to:{ x:600, y: 50 }
        });
    }
});
</script>
<script type="text/javascript" class="source-code skip-copy">
	var zIndex = 200;
	function getZIndex() {
		return ++zIndex;
	}


	function getColor(offset) {
		return '#' + getColorValue(offset) + getColorValue(offset) + getColorValue(offset);
	}
	function getColorValue(offset) {
		var multiplier = 255 - offset;
		var color = (offset + Math.round(Math.random() * multiplier)).toString(16);
		if (color.length == 1)color = '0' + color;
		return color;
	}


	var dragDrop = new ludo.effect.DragDrop({
		useShim:true,
        autoHideShim:false
	});

	dragDrop.addEvent('before', function (dragged, dragDrop) {
		document.id(dragged.el).setStyle('z-index', getZIndex());
        dragDrop.setShimText(dragged.txt);
	});
    dragDrop.addEvent('end', function(dragged, dragDrop){
        if(dragged.shouldFlyBack){
            dragDrop.flyBack();
        }else{
            dragDrop.flyToShim();
        }

    });
    dragDrop.addEvent('animationComplete', function(dragDrop){
        dragDrop.hideShim.delay(100, dragDrop);
    });
	for (var i = 0; i < 10; i++) {
		var el = new Element('div');
        el.addClass('box');
		el.setStyles({
			width:100 + Math.round(Math.random() * 200),
			height:100 + Math.round(Math.random() * 200),
			left:20 + Math.round(Math.random() * 400),
			top:20 + Math.round(Math.random() * 400),
			border:'1px solid ' + getColor(1),
			'background-color':getColor(200)
		});
        if(i%2==0){
            el.set('html', 'I will fly back');
        }
		document.body.adopt(el);
		dragDrop.add({
			el:el,
			txt:'Box number ' + (i + 1),
            shouldFlyBack:(i%2==0)
		});
	}


</script>


</body>
</html>