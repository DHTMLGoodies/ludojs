<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>LudoJS Source: effect/drag.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.ludojs.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">LudoJS</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-language.html">language</a></li><li><a href="module-ludo.html">ludo</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="ludo.Application.html">ludo.Application</a></li><li><a href="ludo.calendar.Base.html">ludo.calendar.Base</a></li><li><a href="ludo.calendar.Calendar.html">ludo.calendar.Calendar</a></li><li><a href="ludo.calendar.Days.html">ludo.calendar.Days</a></li><li><a href="ludo.calendar.MonthSelector.html">ludo.calendar.MonthSelector</a></li><li><a href="ludo.calendar.MonthYearSelector.html">ludo.calendar.MonthYearSelector</a></li><li><a href="ludo.calendar.NavBar.html">ludo.calendar.NavBar</a></li><li><a href="ludo.calendar.TimePicker.html">ludo.calendar.TimePicker</a></li><li><a href="ludo.calendar.Today.html">ludo.calendar.Today</a></li><li><a href="ludo.calendar.YearSelector.html">ludo.calendar.YearSelector</a></li><li><a href="ludo.canvas.Canvas.html">ludo.canvas.Canvas</a></li><li><a href="ludo.canvas.Circle.html">ludo.canvas.Circle</a></li><li><a href="ludo.canvas.Curtain.html">ludo.canvas.Curtain</a></li><li><a href="ludo.canvas.Drag.html">ludo.canvas.Drag</a></li><li><a href="ludo.canvas.Ellipse_ludo.canvas.Ellipse.html">ludo.canvas.Ellipse#ludo.canvas.Ellipse</a></li><li><a href="ludo.canvas.Filter.html">ludo.canvas.Filter</a></li><li><a href="ludo.canvas.Gradient.html">ludo.canvas.Gradient</a></li><li><a href="ludo.canvas.Group.html">ludo.canvas.Group</a></li><li><a href="ludo.canvas.Mask.html">ludo.canvas.Mask</a></li><li><a href="ludo.canvas.NamedNode.html">ludo.canvas.NamedNode</a></li><li><a href="ludo.canvas.Node.html">ludo.canvas.Node</a></li><li><a href="ludo.canvas.Paint.html">ludo.canvas.Paint</a></li><li><a href="ludo.canvas.Path.html">ludo.canvas.Path</a></li><li><a href="ludo.canvas.Polygon.html">ludo.canvas.Polygon</a></li><li><a href="ludo.canvas.Polyline.html">ludo.canvas.Polyline</a></li><li><a href="ludo.canvas.RadialGradient.html">ludo.canvas.RadialGradient</a></li><li><a href="ludo.canvas.Rect.html">ludo.canvas.Rect</a></li><li><a href="ludo.canvas.Stop.html">ludo.canvas.Stop</a></li><li><a href="ludo.canvas.Text.html">ludo.canvas.Text</a></li><li><a href="ludo.canvas.TextBox.html">ludo.canvas.TextBox</a></li><li><a href="ludo.canvas.View.html">ludo.canvas.View</a></li><li><a href="ludo.chart.DataProvider.html">ludo.chart.DataProvider</a></li><li><a href="ludo.chart.Labels.html">ludo.chart.Labels</a></li><li><a href="ludo.chart.Pie.html">ludo.chart.Pie</a></li><li><a href="ludo.chart.PieSliceHighlighted.html">ludo.chart.PieSliceHighlighted</a></li><li><a href="ludo.chart.Record.html">ludo.chart.Record</a></li><li><a href="ludo.CollectionView.html">ludo.CollectionView</a></li><li><a href="ludo.color.Color.html">ludo.color.Color</a></li><li><a href="ludo.controller.Controller.html">ludo.controller.Controller</a></li><li><a href="ludo.controller.Manager.html">ludo.controller.Manager</a></li><li><a href="ludo.Core.html">ludo.Core</a></li><li><a href="ludo.dataSource.Collection.html">ludo.dataSource.Collection</a></li><li><a href="ludo.dataSource.CollectionSearch.html">ludo.dataSource.CollectionSearch</a></li><li><a href="ludo.dataSource.HTML.html">ludo.dataSource.HTML</a></li><li><a href="ludo.dataSource.JSON.html">ludo.dataSource.JSON</a></li><li><a href="ludo.dataSource.Record.html">ludo.dataSource.Record</a></li><li><a href="ludo.dataSource.SearchParser.html">ludo.dataSource.SearchParser</a></li><li><a href="ludo.dataSource.TreeCollection.html">ludo.dataSource.TreeCollection</a></li><li><a href="ludo.dialog.Alert.html">ludo.dialog.Alert</a></li><li><a href="ludo.dialog.Confirm.html">ludo.dialog.Confirm</a></li><li><a href="ludo.dialog.Dialog.html">ludo.dialog.Dialog</a></li><li><a href="ludo.dialog.Prompt.html">ludo.dialog.Prompt</a></li><li><a href="ludo.effect.Drag.html">ludo.effect.Drag</a></li><li><a href="ludo.effect.DragDrop.html">ludo.effect.DragDrop</a></li><li><a href="ludo.effect.DropPoint.html">ludo.effect.DropPoint</a></li><li><a href="ludo.effect.Effect.html">ludo.effect.Effect</a></li><li><a href="ludo.form.Button.html">ludo.form.Button</a></li><li><a href="ludo.form.CancelButton.html">ludo.form.CancelButton</a></li><li><a href="ludo.form.Checkbox.html">ludo.form.Checkbox</a></li><li><a href="ludo.form.Combo.html">ludo.form.Combo</a></li><li><a href="ludo.form.ComboTree.html">ludo.form.ComboTree</a></li><li><a href="ludo.form.Date.html">ludo.form.Date</a></li><li><a href="ludo.form.DisplayField.html">ludo.form.DisplayField</a></li><li><a href="ludo.form.Element.html">ludo.form.Element</a></li><li><a href="ludo.form.Email.html">ludo.form.Email</a></li><li><a href="ludo.form.File.html">ludo.form.File</a></li><li><a href="ludo.form.Label.html">ludo.form.Label</a></li><li><a href="ludo.form.LabelElement.html">ludo.form.LabelElement</a></li><li><a href="ludo.form.Manager.html">ludo.form.Manager</a></li><li><a href="ludo.form.Number.html">ludo.form.Number</a></li><li><a href="ludo.form.OnOffSwitch.html">ludo.form.OnOffSwitch</a></li><li><a href="ludo.form.Password.html">ludo.form.Password</a></li><li><a href="ludo.form.Radio.html">ludo.form.Radio</a></li><li><a href="ludo.form.RadioGroup.html">ludo.form.RadioGroup</a></li><li><a href="ludo.form.ResetButton.html">ludo.form.ResetButton</a></li><li><a href="ludo.form.SearchField.html">ludo.form.SearchField</a></li><li><a href="ludo.form.Seekbar.html">ludo.form.Seekbar</a></li><li><a href="ludo.form.Select.html">ludo.form.Select</a></li><li><a href="ludo.form.Spinner.html">ludo.form.Spinner</a></li><li><a href="ludo.form.StrongPassword.html">ludo.form.StrongPassword</a></li><li><a href="ludo.form.SubmitButton.html">ludo.form.SubmitButton</a></li><li><a href="ludo.form.Text.html">ludo.form.Text</a></li><li><a href="ludo.form.Textarea.html">ludo.form.Textarea</a></li><li><a href="ludo.form.TinbyButton.html">ludo.form.TinbyButton</a></li><li><a href="ludo.form.ToggleButton.html">ludo.form.ToggleButton</a></li><li><a href="ludo.form.ToggleGroup.html">ludo.form.ToggleGroup</a></li><li><a href="ludo.form.validator.Base.html">ludo.form.validator.Base</a></li><li><a href="ludo.form.validator.Md5.html">ludo.form.validator.Md5</a></li><li><a href="ludo.FramedView.html">ludo.FramedView</a></li><li><a href="ludo.grid.ColumnManager.html">ludo.grid.ColumnManager</a></li><li><a href="ludo.grid.Grid.html">ludo.grid.Grid</a></li><li><a href="ludo.grid.RowManager.html">ludo.grid.RowManager</a></li><li><a href="ludo.layout.Accordion.html">ludo.layout.Accordion</a></li><li><a href="ludo.layout.Base.html">ludo.layout.Base</a></li><li><a href="ludo.layout.Canvas.html">ludo.layout.Canvas</a></li><li><a href="ludo.layout.Factory.html">ludo.layout.Factory</a></li><li><a href="ludo.layout.Grid.html">ludo.layout.Grid</a></li><li><a href="ludo.layout.LinearVertical.html">ludo.layout.LinearVertical</a></li><li><a href="ludo.layout.Menu.html">ludo.layout.Menu</a></li><li><a href="ludo.layout.NavBar.html">ludo.layout.NavBar</a></li><li><a href="ludo.layout.Popup.html">ludo.layout.Popup</a></li><li><a href="ludo.layout.Relative.html">ludo.layout.Relative</a></li><li><a href="ludo.layout.Renderer.html">ludo.layout.Renderer</a></li><li><a href="ludo.layout.Table.html">ludo.layout.Table</a></li><li><a href="ludo.layout.ViewPager.html">ludo.layout.ViewPager</a></li><li><a href="ludo.menu.Button.html">ludo.menu.Button</a></li><li><a href="ludo.menu.Context.html">ludo.menu.Context</a></li><li><a href="ludo.menu.DropDown.html">ludo.menu.DropDown</a></li><li><a href="ludo.menu.Menu.html">ludo.menu.Menu</a></li><li><a href="ludo.menu.MenuItem.html">ludo.menu.MenuItem</a></li><li><a href="ludo.Notification.html">ludo.Notification</a></li><li><a href="ludo.ObjectFactory.html">ludo.ObjectFactory</a></li><li><a href="ludo.paging.Button.html">ludo.paging.Button</a></li><li><a href="ludo.paging.First.html">ludo.paging.First</a></li><li><a href="ludo.paging.Last.html">ludo.paging.Last</a></li><li><a href="ludo.paging.NavBar.html">ludo.paging.NavBar</a></li><li><a href="ludo.paging.Next.html">ludo.paging.Next</a></li><li><a href="ludo.paging.PageInput.html">ludo.paging.PageInput</a></li><li><a href="ludo.paging.PageSize.html">ludo.paging.PageSize</a></li><li><a href="ludo.paging.TotalPages.html">ludo.paging.TotalPages</a></li><li><a href="ludo.Panel.html">ludo.Panel</a></li><li><a href="ludo.progress.Bar.html">ludo.progress.Bar</a></li><li><a href="ludo.progress.Base.html">ludo.progress.Base</a></li><li><a href="ludo.progress.DataSource.html">ludo.progress.DataSource</a></li><li><a href="ludo.progress.Text.html">ludo.progress.Text</a></li><li><a href="ludo.remote.Broadcaster.html">ludo.remote.Broadcaster</a></li><li><a href="ludo.remote.ErrorMessage.html">ludo.remote.ErrorMessage</a></li><li><a href="ludo.remote.HTML.html">ludo.remote.HTML</a></li><li><a href="ludo.remote.html#.JSON">ludo.remote.JSON</a></li><li><a href="ludo.storage.LocalStorage.html">ludo.storage.LocalStorage</a></li><li><a href="ludo.tpl.Parser.html">ludo.tpl.Parser</a></li><li><a href="ludo.tree.Filter.html">ludo.tree.Filter</a></li><li><a href="ludo.tree.Modifications.html">ludo.tree.Modifications</a></li><li><a href="ludo.tree.Tree.html">ludo.tree.Tree</a></li><li><a href="ludo.video.YouTube.html">ludo.video.YouTube</a></li><li><a href="ludo.View.html">ludo.View</a></li><li><a href="ludo.view.ViewPagerNav.html">ludo.view.ViewPagerNav</a></li><li><a href="ludo.Window.html">ludo.Window</a></li><li><a href="TreeCollectionSearch.html">TreeCollectionSearch</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#toHSV">toHSV</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		<h1 class="page-title">Source: effect/drag.js</h1>
    
<section>
    <article>
        <pre
            class="sunlight-highlight-javascript linenums">/**
 * Class for dragging DOM elements.
 @namespace ludo.effect
 @class ludo.effect.Drag
 @augments ludo.effect.Effect

 @param {Object} config
 @param {Number} config.minX Optional minimum left coordinate
 @param {Number} config.maxX Optional maximum left coordinate
 @param {Number} config.minY Optional minimum top coordinate
 @param {Number} config.maxY Optional maximum top coordinate
 @param {Number} config.maxY Optional maximum top coordinate
 @param {String|HTMLElement} config.el This element is draggable.
 @param {String|HTMLElement} config.handle Optional dom element. Mouse down on this element will initiate the drag process. example: A title bar above a view. If not set, Mouse down on this.el will initiate dragging.
 @param {String} config.directions Accept dragging in these directions, default: "XY". For horizontal dragging only, use "X" and for vertical "Y".
 @param {Number} config.minPos Alternative to minX and minY when you only accepts dragging along the X or Y-axis.
 @param {Number} config.maxPos Alternative to maxX and maxY when you only accepts dragging along the X or Y-axis.
 @param {Number} config.delay Optional delay in seconds from mouse down to dragging starts. Default: 0
 @param {Boolean} config.useShim True to drag a "ghost" DOM element while dragging, default: false
 @param {String} config.shimCls Name of css class to add to the shim
 @param {Boolean} config.autoHideShim True to automatically hide shim on drag end, default: true
 @param {Number} config.mouseYOffset While dragging, always show dragged element this amount of pixels below mouse cursor.
 @param {Number} config.mouseXOffset While dragging, always show dragged element this amount of pixels right of mouse cursor.
 @param {String} config.unit Unit used while dragging, default: "px"


 @fires ludo.effect.Drag#before Event fired before drag starts. Params: 1) Dom element to be dragged, 2) ludo.effect.Drag, 3) {x,y}
 @fires ludo.effect.Drag#start Event when drag starts. Params: 1) Dom element to be dragged, 2) ludo.effect.Drag, 3) {x,y}
 @fires ludo.effect.Drag#drag' Event when drag ends. Params: 1) Dom element to be dragged, 2) ludo.effect.Drag, 3) {x,y}
 @fires ludo.effect.Drag#end' Event when drag ends. Params: 1) {x,y}, 2) dragged node 3) ludo.effect.Drag
 @fires ludo.effect.Drag#showShim' Event fired when shim DOM node is shown. Argument: 1) Shim DOM Node, 2) ludo.effect.Drag
 @fires ludo.effect.Drag#flyToShim' Event fired after flyBack animation is complete. Arguments: 1) ludo.effect.Drag, 2) Shim DOM node
 @fires ludo.effect.Drag#flyBack' Event fired when shim DOM node is shown. Argument: Arguments: 1) ludo.effect.Drag, 2) Shim DOM node


 @example
 &lt;style type="text/css">
 .ludo-shim {
		 border: 15px solid #AAA;
		 background-color: #DEF;
		 margin: 5;
		 opacity: .5;
		 border-radius: 5px;
	}
 .draggable{
		width:150px;
		z-index:1000;
		height:150px;
		border-radius:5px;
		border:1px solid #555;
		background-color:#DEF
	}
 &lt;/style>
 &lt;div id="draggable" class="draggable">
 I am draggable
 &lt;/div>
 &lt;script type="text/javascript">
 var d = new ludo.effect.Drag({
		useShim:true,
		 listeners:{
			 endDrag:function(dragged, dragEffect){
				 dragEffect.getEl().setStyles({
					 left : dragEffect.getX(),
					 top: dragEffect.getY()
				 });
			 },
			 drag:function(pos, dragEffect){
				 dragEffect.setShimText(dragEffect.getX() + 'x' + dragEffect.getY());
			 }
		 }
	 });
 d.add('draggable'); // "draggable" is the id of the div
 &lt;/script>

 */
ludo.effect.Drag = new Class({
    Extends: ludo.effect.Effect,


    handle: undefined,

    el: undefined,


    minX: undefined,

    minY: undefined,


    maxX: undefined,

    maxY: undefined,


    minPos: undefined,

    maxPos: undefined,

    directions: 'XY',


    unit: 'px',

    dragProcess: {
        active: false
    },

    coordinatesToDrag: undefined,

    delay: 0,

    inDelayMode: false,

    els: {},


    useShim: false,


    autoHideShim: true,


    shimCls: undefined,

    mouseYOffset: undefined,


    mouseXOffset: undefined,

    fireEffectEvents: true,

    __construct: function (config) {
        this.parent(config);
        if (config.el !== undefined) {
            this.add({
                el: config.el,
                handle: config.handle
            });
        }

        this.setConfigParams(config, ['useShim', 'autoHideShim', 'directions', 'delay', 'minX', 'maxX', 'minY', 'maxY',
            'minPos', 'maxPos', 'unit', 'shimCls', 'mouseYOffset', 'mouseXOffset', 'fireEffectEvents']);
    },

    ludoEvents: function () {
        this.parent();
        this.getEventEl().on(ludo.util.getDragMoveEvent(), this.drag.bind(this));
        this.getEventEl().on(ludo.util.getDragEndEvent(), this.endDrag.bind(this));
        if (this.useShim) {
            this.addEvent('start', this.showShim.bind(this));
            if (this.autoHideShim) {
                this.addEvent('end', this.hideShim.bind(this));
            }
        }
    },

    /**
     Add draggable object
     @function add
     @param {effect.DraggableNode|String|HTMLDivElement} node
     @memberof ludo.effect.Effect.prototype
     @return {effect.DraggableNode}
     @example
     dragObject.add({
			el: 'myDiv',
			handle : 'myHandle'
		});
     handle is optional.

     @example
     dragObject.add('idOfMyDiv');

     You can also add custom properties:

     @example
     dragobject.add({
	 		id: "myReference',
			el: 'myDiv',
			column: 'city'
		});
     ...
     ...
     dragobject.addEvent('before', beforeDrag);
     ...
     ...
     function beforeDrag(dragged){
	 		console.log(dragged.el);
	 		console.log(dragged.column);
	 	}
     */
    add: function (node) {
        node = this.getValidNode(node);
        var el = $(node.el);
        this.setPositioning(el);

        var handle = node.handle ? $(node.handle) : el;

        handle.attr("id",  handle.id || 'ludo-' + String.uniqueID());
        handle.addClass("ludo-drag");

        handle.on(ludo.util.getDragStartEvent(), this.startDrag.bind(this));
        handle.attr('forId', node.id);
        this.els[node.id] = Object.merge(node, {
            el: $(el),
            handle: handle
        });
        return this.els[node.id];
    },

    /**
     * Remove node
     * @function remove
     * @param {String} id
     * @return {Boolean} success
     * @memberof ludo.effect.Effect.prototype
     */
    remove: function (id) {
        if (this.els[id] !== undefined) {
            var el = $("#" + this.els[id].handle);
            el.off(ludo.util.getDragStartEvent(), this.startDrag.bind(this));
            this.els[id] = undefined;
            return true;
        }
        return false;
    },

    removeAll: function () {
        var keys = Object.keys(this.els);
        for (var i = 0; i &lt; keys.length; i++) {
            this.remove(keys[i]);
        }
        this.els = {};
    },

    getValidNode: function (node) {
        if (!this.isElConfigObject(node)) {
            node = {
                el: $(node)
            };
        }
        if (typeof node.el === 'string') {
            if (node.el.substr(0, 1) != "#")node.el = "#" + node.el;
            node.el = $(node.el);
        }
        node.id = node.id || node.el.attr("id") || 'ludo-' + String.uniqueID();
        if (!node.el.attr("id"))node.el.attr("id", node.id);
        node.el.attr('forId', node.id);
        return node;
    },

    isElConfigObject: function (config) {
        return config.el !== undefined || config.handle !== undefined;
    },

    setPositioning: function (el) {
        if (!this.useShim) {
            el.css('position', 'absolute');
        } else {
            var pos = el.css('position');
            if (!pos || (pos != 'relative' &amp;&amp; pos != 'absolute')) {
                el.css('position', 'relative');
            }
        }
    },

    getById: function (id) {
        return this.els[id];
    },

    getIdByEvent: function (e) {
        var el = $(e.target);
        if (!el.hasClass('ludo-drag')) {
            el = el.closest('.ludo-drag');
        }
        return el.attr('forId');
    },


    getDragged: function () {
        return this.els[this.dragProcess.dragged];
    },

    /**
     * Returns reference to draggable DOM node
     * @function getEl
     * @return {HTMLElement} DOMNode
     * @memberof ludo.effect.Effect.prototype
     */
    getEl: function () {
        return this.els[this.dragProcess.dragged].el;
    },

    getShimOrEl: function () {
        return this.useShim ? this.getShim() : this.getEl();
    },

    getSizeOf: function (el) {
        return el.outerWidth !== undefined ? {x: el.outerWidth(), y: el.outerHeight()} : {x: 0, y: 0};
    },

    getPositionOf: function (el) {

        return $(el).position();
    },

    setDragCoordinates: function () {
        this.coordinatesToDrag = {
            x: 'x', y: 'y'
        };
    },
    startDrag: function (e) {
        var id = this.getIdByEvent(e);

        var el = this.getById(id).el;

        var size = this.getSizeOf(el);
        var pos;
        if (this.useShim) {
            pos = el.position();
        } else {
            var parent = this.getPositionedParent(el);
            pos = parent ? el.getPosition(parent) : this.getPositionOf(el)
        }

        var x = pos.left;
        var y = pos.top;
        this.dragProcess = {
            active: true,
            dragged: id,
            currentX: x,
            currentY: y,
            elX: x,
            elY: y,
            width: size.x,
            height: size.y,
            mouseX: e.pageX,
            mouseY: e.pageY
        };


        this.dragProcess.el = this.getShimOrEl();

        this.fireEvent('before', [this.els[id], this, {x: x, y: y}]);

        if (!this.isActive()) {
            return undefined;
        }

        this.dragProcess.minX = this.getMinX();
        this.dragProcess.maxX = this.getMaxX();
        this.dragProcess.minY = this.getMinY();
        this.dragProcess.maxY = this.getMaxY();
        this.dragProcess.dragX = this.canDragAlongX();
        this.dragProcess.dragY = this.canDragAlongY();

        if (this.delay) {
            this.setActiveAfterDelay();
        } else {

            this.fireEvent('start', [this.els[id], this, {x: x, y: y}]);

            if (this.fireEffectEvents)ludo.EffectObject.start();
        }

        return false;
    },

    getPositionedParent: function (el) {

        var parent = el.parentNode;
        while (parent) {
            var pos = parent.getStyle('position');
            if (pos === 'relative' || pos === 'absolute')return parent;
            parent = parent.getParent();
        }
        return undefined;
    },

    /**
     Cancel drag. This method is designed to be called from an event handler
     attached to the "beforeDrag" event.
     @function cancelDrag
     @memberof ludo.effect.Effect.prototype
     @example
     // Here, dd is a {{#crossLink "effect.Drag"}}{{/crossLink}} object
     dd.on('before', function(draggable, dd, pos){
	 		if(pos.x > 1000 || pos.y > 500){
	 			dd.cancelDrag();
			}
	 	});
     In this example, dragging will be cancelled when the x position of the mouse
     is greater than 1000 or if the y position is greater than 500. Another more
     useful example is this:
     @example
     dd.on('before', function(draggable, dd){
		 	if(!this.isDraggable(draggable)){
		 		dd.cancelDrag()
		 	}
		});
     Here, we assume that we have an isDraggable method which returns true or false
     for whether the given node is draggable or not. "draggable" in this example
     is one of the {{#crossLink "effect.DraggableNode"}}{{/crossLink}} objects added
     using the {{#crossLink "effect.Drag/add"}}{{/crossLink}} method.
     */

    cancelDrag: function () {
        this.dragProcess.active = false;
        this.dragProcess.el = undefined;
        if (this.fireEffectEvents)ludo.EffectObject.end();
    },

    getShimFor: function (el) {
        return el;
    },

    setActiveAfterDelay: function () {
        this.inDelayMode = true;
        this.dragProcess.active = false;
        this.startIfMouseNotReleased.delay(this.delay * 1000, this);
    },

    startIfMouseNotReleased: function () {
        if (this.inDelayMode) {
            this.dragProcess.active = true;
            this.inDelayMode = false;
            this.fireEvent('start', [this.getDragged(), this, {x: this.getX(), y: this.getY()}]);
            ludo.EffectObject.start();
        }
    },

    drag: function (e) {
        if (this.dragProcess.active &amp;&amp; this.dragProcess.el) {
            var pos = {
                x: undefined,
                y: undefined
            };
            if (this.dragProcess.dragX) {
                pos.x = this.getXDrag(e);

            }

            if (this.dragProcess.dragY) {
                pos.y = this.getYDrag(e);
            }


            this.move(pos);

            /*
             * Event fired while dragging. Sends position, example {x:100,y:50}
             * and reference to effect.Drag as arguments
             * @event drag
             * @param {Object} x and y
             * @param {effect.Drag} this
             */
            this.fireEvent('drag', [pos, this.els[this.dragProcess.dragged], this]);
            if (ludo.util.isTabletOrMobile())return false;

        }
        return undefined;
    },

    move: function (pos) {
        if (pos.x !== undefined) {
            this.dragProcess.currentX = pos.x;
            this.dragProcess.el.css('left', pos.x + this.unit);
        }
        if (pos.y !== undefined) {
            this.dragProcess.currentY = pos.y;
            this.dragProcess.el.css('top', pos.y + this.unit);
        }
    },

    /**
     * Return current x pos
     * @function getX
     * @return {Number} x
     * @memberof ludo.effect.Effect.prototype
     */
    getX: function () {
        return this.dragProcess.currentX;
    },
    /**
     * Return current y pos
     * @function getY
     * @return {Number} y
     * @memberof ludo.effect.Effect.prototype
     */
    getY: function () {
        return this.dragProcess.currentY;
    },

    getXDrag: function (e) {
        var posX;

        if (this.mouseXOffset) {
            posX = e.pageX + this.mouseXOffset;
        } else {
            posX = e.pageX - this.dragProcess.mouseX + this.dragProcess.elX;
        }

        if (posX &lt; this.dragProcess.minX) {
            posX = this.dragProcess.minX;
        }
        if (posX > this.dragProcess.maxX) {
            posX = this.dragProcess.maxX;
        }
        return posX;
    },

    getYDrag: function (e) {
        var posY;
        if (this.mouseYOffset) {
            posY = e.pageY + this.mouseYOffset;
        } else {
            posY = e.pageY - this.dragProcess.mouseY + this.dragProcess.elY;
        }

        if (posY &lt; this.dragProcess.minY) {
            posY = this.dragProcess.minY;
        }
        if (posY > this.dragProcess.maxY) {
            posY = this.dragProcess.maxY;
        }
        return posY;
    },

    endDrag: function () {
        if (this.dragProcess.active) {
            this.cancelDrag();

            this.fireEvent('end', [
                this.getDragged(),
                this,
                {
                    x: this.getX(),
                    y: this.getY()
                }
            ]);

        }
        if (this.inDelayMode)this.inDelayMode = false;

    },

    /**
     * Set new max X pos
     * @function setMaxX
     * @param {Number} x
     * @memberof ludo.effect.Effect.prototype
     */
    setMaxX: function (x) {
        this.maxX = x;
    },
    /**
     * Set new min X pos
     * @function setMinX
     * @param {Number} x
     * @memberof ludo.effect.Effect.prototype
     */
    setMinX: function (x) {
        this.minX = x;
    },
    /**
     * Set new min Y pos
     * @function setMinY
     * @param {Number} y
     * @memberof ludo.effect.Effect.prototype
     */
    setMinY: function (y) {
        this.minY = y;
    },
    /**
     * Set new max Y pos
     * @function setMaxY
     * @param {Number} y
     * @memberof ludo.effect.Effect.prototype
     */
    setMaxY: function (y) {
        this.maxY = y;
    },
    /**
     * Set new min pos
     * @function setMinPos
     * @param {Number} pos
     * @memberof ludo.effect.Effect.prototype
     */
    setMinPos: function (pos) {
        this.minPos = pos;
    },
    /**
     * Set new max pos
     * @function setMaxPos
     * @param {Number} pos
     * @memberof ludo.effect.Effect.prototype
     */
    setMaxPos: function (pos) {
        this.maxPos = pos;
    },

    getMaxX: function () {
        return this.getMaxPos('maxX');
    },

    getMaxY: function () {
        return this.getMaxPos('maxY');
    },

    getMaxPos: function (key) {
        var max = this.getConfigProperty(key);
        return max !== undefined ? max : this.maxPos !== undefined ? this.maxPos : 100000;
    },

    getMinX: function () {
        var minX = this.getConfigProperty('minX');
        return minX !== undefined ? minX : this.minPos;
    },

    getMinY: function () {
        var dragged = this.getDragged();
        return dragged &amp;&amp; dragged.minY !== undefined ? dragged.minY : this.minY !== undefined ? this.minY : this.minPos;
    },
    /**
     * Return amount dragged in x direction
     * @function getDraggedX
     * @return {Number} x
     * @memberof ludo.effect.Effect.prototype
     */
    getDraggedX: function () {
        return this.getX() - this.dragProcess.elX;
    },
    /**
     * Return amount dragged in y direction
     * @function getDraggedY
     * @return {Number} y
     * @memberof ludo.effect.Effect.prototype
     */
    getDraggedY: function () {
        return this.getY() - this.dragProcess.elY;
    },

    canDragAlongX: function () {
        return this.getConfigProperty('directions').indexOf('X') >= 0;
    },
    canDragAlongY: function () {
        return this.getConfigProperty('directions').indexOf('Y') >= 0;
    },

    getConfigProperty: function (property) {
        var dragged = this.getDragged();
        return dragged &amp;&amp; dragged[property] !== undefined ? dragged[property] : this[property];
    },

    /**
     * Returns width of dragged element
     * @function getHeight
     * @return {Number}
     * @memberof ludo.effect.Effect.prototype
     */
    getWidth: function () {
        return this.dragProcess.width;
    },

    /**
     * Returns height of dragged element
     * @function getHeight
     * @return {Number}
     * @memberof ludo.effect.Effect.prototype
     */
    getHeight: function () {
        return this.dragProcess.height;
    },
    /**
     * Returns current left position of dragged
     * @function getLeft
     * @return {Number}
     * @memberof ludo.effect.Effect.prototype
     */
    getLeft: function () {
        return this.dragProcess.currentX;
    },

    /**
     * Returns current top/y position of dragged.
     * @function getTop
     * @return {Number}
     * @memberof ludo.effect.Effect.prototype
     */
    getTop: function () {
        return this.dragProcess.currentY;
    },

    /**
     * Returns reference to DOM element of shim
     * @function getShim
     * @return {HTMLDivElement} shim
     * @memberof ludo.effect.Effect.prototype
     */
    getShim: function () {
        if (this.shim === undefined) {
            this.shim = $('&lt;div>');
            this.shim.addClass('ludo-shim');
            this.shim.css({
                position: 'absolute',
                'z-index': 50000,
                display: 'none'
            });
            $(document.body).append(this.shim);

            if (this.shimCls) {
                for (var i = 0; i &lt; this.shimCls.length; i++) {
                    this.shim.addClass(this.shimCls[i]);
                }
            }

            this.fireEvent('createShim', this.shim);
        }
        return this.shim;
    },


    showShim: function () {
        this.getShim().css({
            display: '',
            left: this.getShimX(),
            top: this.getShimY(),
            width: this.getWidth() + this.getShimWidthDiff(),
            height: this.getHeight() + this.getShimHeightDiff()
        });

        this.fireEvent('showShim', [this.getShim(), this]);
    },

    getShimY: function () {
        if (this.mouseYOffset) {
            return this.dragProcess.mouseY + this.mouseYOffset;
        } else {
            return this.getTop() + ludo.dom.getMH(this.getEl()) - ludo.dom.getMW(this.shim);
        }
    },

    getShimX: function () {
        if (this.mouseXOffset) {
            return this.dragProcess.mouseX + this.mouseXOffset;
        } else {
            return this.getLeft() + ludo.dom.getMW(this.getEl()) - ludo.dom.getMW(this.shim);
        }
    },

    getShimWidthDiff: function () {
        return ludo.dom.getMW(this.getEl()) - ludo.dom.getMBPW(this.shim);
    },
    getShimHeightDiff: function () {
        return ludo.dom.getMH(this.getEl()) - ludo.dom.getMBPH(this.shim);
    },

    /**
     * Hide shim
     * @function hideShim
     * @memberof ludo.effect.Effect.prototype
     */
    hideShim: function () {
        this.getShim().css('display', 'none');
    },

    /**
     * Set text content of shim
     * @function setShimText
     * @param {String} text
     * @memberof ludo.effect.Effect.prototype
     */
    setShimText: function (text) {
        this.getShim().html(text);
    },

    /**
     * Fly/Slide dragged element back to it's original position
     * @function flyBack
     * @memberof ludo.effect.Effect.prototype
     */
    flyBack: function (duration) {
        this.fly({
            el: this.getShimOrEl(),
            duration: duration,
            from: {x: this.getLeft(), y: this.getTop()},
            to: {x: this.getStartX(), y: this.getStartY()},
            onComplete: this.flyBackComplete.bind(this)
        });
    },

    /**
     * Fly/Slide dragged element to position of shim. This will only
     * work when useShim is set to true.
     * @function flyToShim
     * @param {Number} duration in seconds(default = .2)
     * @memberof ludo.effect.Effect.prototype
     */
    flyToShim: function (duration) {
        this.fly({
            el: this.getEl(),
            duration: duration,
            from: {x: this.getStartX(), y: this.getStartY()},
            to: {x: this.getLeft(), y: this.getTop()},
            onComplete: this.flyToShimComplete.bind(this)
        });
    },

    getStartX: function () {
        return this.dragProcess.elX;
    },

    getStartY: function () {
        return this.dragProcess.elY;
    },

    flyBackComplete: function () {

        this.fireEvent('flyBack', [this, this.getShimOrEl()]);
    },

    flyToShimComplete: function () {
        this.fireEvent('flyToShim', [this, this.getEl()]);
    },

    isActive: function () {
        return this.dragProcess.active;
    }
});</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


	<span class="copyright">
	© LudoJS.com 2012-2016
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.2</a>
	
		on Tue Nov 29th 2016
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->

<script>
	(function ( i, s, o, g, r, a, m ) {
		i['GoogleAnalyticsObject'] = r;
		i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push( arguments )
		}, i[r].l = 1 * new Date();
		a = s.createElement( o ),
			m = s.getElementsByTagName( o )[0];
		a.async = 1;
		a.src = g;
		m.parentNode.insertBefore( a, m )
	})( window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga' );

	ga( 'create', 'UA-34153510-1', 'http://www.ludojs.com' );
	ga( 'send', 'pageview' );
</script>



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>
